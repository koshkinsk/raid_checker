import unittest
from nose import tools
import raid_health
import os

ME = os.path.dirname(__file__)
FIXTURES = os.path.join(ME, 'fixtures')


class TestNormalState(unittest.TestCase):

    def setUp(self):
        self.PARTITIONS = raid_health.PARTITIONS
        raid_health.PARTITIONS = os.path.join(FIXTURES, 'partitions')
        self.MDSTAT = raid_health.MDSTAT
        raid_health.MDSTAT = os.path.join(FIXTURES, 'mdstat_normal')

    def tearDown(self):
        raid_health.PARTITIONS = self.PARTITIONS
        raid_health.MDSTAT = self.MDSTAT

    def test_get_arrays(self):
        arrs = raid_health.get_arrays()
        tools.eq_(len(arrs), 2)
        tools.eq_(arrs[0], 'md0')
        tools.eq_(arrs[1], 'md1')

    def test_get_used_hdds(self):
        hdds = raid_health.get_used_hdds()
        tools.eq_(len(hdds), 4)
        tools.eq_(hdds[0], 'sda1')

    def test_find_hotspare_hdd(self):
        print(raid_health.find_hotspare_hdd())
